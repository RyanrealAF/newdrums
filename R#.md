# R#: Free Visual Software That Reads MIDI

## Overview

R# is a Python-based visual programming framework designed for real-time audio-visual performance and interactive media. This document outlines how R# can be used with MIDI files generated by the audio-to-MIDI conversion tool in this project.

## Key Features

- Real-time MIDI file playback and event processing
- Audio-reactive visual generation
- Support for various visual effects and animations
- Color-changing effects that respond to note numbers
- Particle emitter effects that react to velocity
- Note number to color mapping
- Velocity to size/intensity mapping
- Simple, intuitive interface built with pygame

## Getting Started

### Installation

R# comes pre-installed with this project. Ensure you have all dependencies installed:

```bash
pip install -r requirements.txt
```

### Loading MIDI Files

1. First, generate a MIDI file from your audio using `audio_to_midi.py`:
   ```bash
   python audio_to_midi.py your_track.wav --output output.mid --bpm 120 --dynamic
   ```

2. Run the R# visualizer:
   ```bash
   python rsharp.py output.mid --bpm 120
   ```

### Example Workflow

R# automatically handles MIDI file playback and visual effect triggering. The default configuration includes:

```
MIDI File Input → Note On/Off Detector → Color Changer → Particle Emitter → Screen Output
```

## MIDI to Visual Mapping

R# provides flexible mapping between MIDI events and visual parameters. Current mappings include:

- **Note On**: Trigger a visual event (flash, particle burst)
- **Note Off**: End a visual event (fade out)
- **Velocity**: Control visual intensity (brightness, size, number of particles)
- **Note Number**: Control visual color (hue based on note number)

## Integration with OBS

To use R# visuals in OBS:

1. Install the OBS Virtual Camera plugin
2. In R#, run the visualizer
3. In OBS, add a "Window Capture" source
4. Select the R# window from the list

## Advanced Usage

### Custom Visual Effects

R# supports custom visual effects by creating new classes inheriting from `VisualEffect`:

```python
class MyCustomEffect(VisualEffect):
    def __init__(self, x, y):
        super().__init__()
        self.x = x
        self.y = y
        
    def trigger(self, event):
        if event['type'] == 'note_on':
            # Custom event handling
            pass
            
    def update(self):
        # Custom update logic
        pass
        
    def render(self, screen):
        # Custom rendering
        pass
```

### Multiple Effects

Add multiple effects to the R# instance:

```python
rsharp = RSharp("output.mid", 120)
rsharp.add_visual_effect(ColorChangerEffect())
rsharp.add_visual_effect(ParticleEmitterEffect())
rsharp.add_visual_effect(MyCustomEffect())
rsharp.run()
```

## Compatibility

R# is compatible with MIDI files generated by this project. The default MIDI note (36/Kick Drum) works well for triggering percussion-based visuals.

## Troubleshooting

- **MIDI file not loading**: Check that the MIDI file path is correct and the file is not corrupted
- **Visuals not triggering**: Verify the MIDI event to visual parameter mapping
- **Performance issues**: Reduce the number of active visual effects or lower the resolution

## Future Development

- Node-based visual programming interface
- Real-time MIDI input support (via MIDI controllers)
- OSC (Open Sound Control) communication
- Virtual camera/NDI output for OBS integration
- Advanced audio analysis features (e.g., frequency tracking, beat detection)
- 3D visual rendering capabilities
- More visual effect types (e.g., waves, shapes, text)
- Integration with virtual reality (VR) and augmented reality (AR) platforms
